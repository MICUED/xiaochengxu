# 微信小程序定位测试

## 1、测试内容
1. js代码设置定时器，每隔1s获取定位信息
2. 调试工具中打印位置信息及定时器执行次数
3. 将位置信息渲染到页面上，并存到缓存中
4. js代码设置定时器，单纯打印定时器执行次数
[代码地址](https://github.com/necfol/xiaochengxu/blob/master/pages/index/index.js)

## 2、结果及结论
1.当纯粹执行打印代码，微信退到后台或者其他任何操作，控制台会一直打印内容，即js线程会一直运行<br>
结论：

```
当用户点击左上角关闭，或者直接按home键，小程序并没有直接销毁，而是进入了后台；当再次进入微信或再次打开小程序，小程序又会从后台进入前台

```
从网上文章看到的内容还提到，当小程序进入后台一定的时间之后，或者系统资源占用过高，小程序会被销毁。

2.当定时器中使用获取位置信息接口时，除非用户点击“显示在聊天顶部”，否则小程序在后台此接口一直不会被调用。定位接口符合官方Api描述，即:

```
当用户离开小程序后，此接口无法调用；当用户点击“显示在聊天顶部”时，此接口可继续调用。
```
[Api](https://mp.weixin.qq.com/debug/wxadoc/dev/api/location.html)


## 3、和普通App对比
### 3.1 开发
1. 和RN相比，不支持加载npm依赖
2. 语法上糅合了React和Vue，更倾向于Vue，开发简单迅速易上手
3. 调试编译都很方便，一键在手机上预览，比原生，RN，Weex都方便
4. 编辑器略显lowB
5. 目前情况来看，小程序并没有社区支持一些组件之类的，应该是仅限于官方提供的组件（本身也够使用，并且符合微信设计规范）
6. 一些国内App常做的微信分享，转发，微信支付之类的，使用小程序开发基本上可以一个接口搞定，涉及到这方面的开发效率显著提升
7. 小程序的大小被严格限制，小程序源码打包后的大小限制为1M，单次通过网络传输的数据最大也是1M。名副其实的“小”程序


### 3.1 其他
1. 只开发微信小程序应用，就意味着用户资源是被微信所掌握，自己并没有用户资源及用户入口。
2. 适合工具类的应用，“用完即走”
3. 发布需要微信的审核，尺度不好把握
4. 用户更容易获取，不用下载，点击即用
5. 和线下结合更紧密，这一点从摩拜单车可以提现，微信扫一扫，直接进入摩拜应用
6. 小程序的推送需要用户激活，当用户在小程序内部提交过表单或者完成过支付后，可允许开发者向用户在7天内推送1条预设模板的信息。



